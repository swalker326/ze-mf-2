"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.cleanTokens = exports.removeToken = exports.getToken = exports.saveToken = void 0;
const node_persist_1 = require("node-persist");
const node_os_1 = require("node:os");
const node_path_1 = require("node:path");
const storage_keys_1 = require("./storage-keys");
const secret_token_1 = require("./secret-token");
const storage = (0, node_persist_1.init)({
    dir: (0, node_path_1.join)((0, node_os_1.homedir)(), storage_keys_1.ZE_PATH),
});
async function saveToken(token) {
    await storage;
    await (0, node_persist_1.setItem)(storage_keys_1.StorageKeys.ze_auth_token, token);
}
exports.saveToken = saveToken;
async function getToken() {
    const tokenFromEnv = (0, secret_token_1.getSecretToken)();
    if (tokenFromEnv) {
        return tokenFromEnv;
    }
    await storage;
    return (0, node_persist_1.getItem)(storage_keys_1.StorageKeys.ze_auth_token);
}
exports.getToken = getToken;
async function removeToken() {
    await storage;
    await (0, node_persist_1.removeItem)(storage_keys_1.StorageKeys.ze_auth_token);
}
exports.removeToken = removeToken;
async function cleanTokens() {
    await storage;
    await (0, node_persist_1.clear)();
}
exports.cleanTokens = cleanTokens;
//# sourceMappingURL=token.js.map