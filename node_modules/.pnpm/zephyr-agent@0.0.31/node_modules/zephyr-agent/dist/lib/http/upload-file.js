"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.uploadFile = void 0;
const ze_http_request_1 = require("./ze-http-request");
const errors_1 = require("../errors");
async function uploadFile({ hash, asset }, { EDGE_URL, jwt }) {
    const type = 'file';
    const options = {
        method: 'POST',
        headers: {
            'x-file-size': asset.size.toString(),
            'x-file-path': asset.path,
            can_write_jwt: jwt,
            'Content-Type': 'application/octet-stream',
        },
    };
    const [ok, cause] = await ze_http_request_1.ZeHttpRequest.from({
        path: '/upload',
        base: EDGE_URL,
        query: { type, hash, filename: asset.path },
    }, options, asset.buffer);
    if (!ok) {
        throw new errors_1.ZephyrError(errors_1.ZeErrors.ERR_FAILED_UPLOAD, {
            type: 'file',
            cause,
        });
    }
}
exports.uploadFile = uploadFile;
//# sourceMappingURL=upload-file.js.map